<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Awkward and Proud</title>
    <meta name="description" content="Please, never say &quot;widgets&quot; in my presence again."/>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="/favicon.png" rel="icon">
    <link href="/atom.xml" rel="alternate" title="Awkward and Proud" type="application/atom+xml">
    <link rel="stylesheet" type="text/css" href="/stylesheets/main.css"/>

    <script src="/javascripts/main.js"></script>
  </head>

  <body>
    <div id="wrapper">
      <h1><a href="/">Awkward and Proud</a></h1>

      <div id="description">
        <ul class="meta">
          <li><a href="/about">About</a> / <a href="/atom.xml">RSS</a></li>
        </ul>
      </div>

      <section id="posts">
  <article class="post">
    <h2 class="permalink">
      <a title="" href="">2010-09-17</a>
    </h2>

    <div class="post-body">
      <h3 class="title">Rails migrations - Checking the existence of a table</h3>
      <p>Recently, I had to drop a table because I no longer needed the model at all. However, working on a distributed team, there were other folks with varying levels of &quot;migration&quot; status for their databases. A first migration to drop the table would be simply the following: </p>

<script src="http://gist.github.com/530421.js?file=original_migration.rb"></script> 

<p>However, I also wanted to get rid of the original migration file that created the file to begin with, since it was no longer meaningful. As it turns out, checking the existence of a table isn't complicated at all: </p>

<script src="http://gist.github.com/530421.js?file=better_migration.rb"></script> 

<p>Now, folks who never had that table to begin with won't get an error when running <code>rake db:migrate</code>, and those who did will simply drop it. This works because <code>connection</code> is actually delegated to <code>ActiveRecord::Base.connection</code>.</p>

<p>As a disclaimer, I've only used this technique in Rails 2.3, so I can't vouch for it working in other versions.</p>

    </div>
  </article>
</section>


    </div>

    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-330362-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
